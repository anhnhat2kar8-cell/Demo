local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CollectionService = game:GetService("CollectionService")

local lp = Players.LocalPlayer
local char = lp.Character or lp.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- ===== GUI =====
local gui = Instance.new("ScreenGui")
gui.Name = "DeltaAutoFarm"
gui.Parent = game.CoreGui

local btn = Instance.new("TextButton")
btn.Parent = gui
btn.Size = UDim2.new(0,200,0,50)
btn.Position = UDim2.new(0,20,0,200)
btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
btn.TextColor3 = Color3.fromRGB(0,255,0)
btn.Text = "AUTO FARM : OFF"
btn.TextScaled = true
btn.Active = true
btn.Draggable = true

-- ===== SETTING =====
local AutoFarm = false
local TeleOffset = CFrame.new(0,0,-3)

-- ===== TÌM NPC =====
local function getNPC()
    for _,npc in pairs(CollectionService:GetTagged("NPC")) do
        if npc:FindFirstChild("Humanoid")
        and npc:FindFirstChild("HumanoidRootPart")
        and npc.Humanoid.Health > 0 then
            return npc
        end
    end
end

-- ===== GIẾT NPC (CLIENT) =====
local function kill(npc)
    pcall(function()
        npc.Humanoid.Health = 0
    end)
end

-- ===== LOOP =====
task.spawn(function()
    while task.wait(0.1) do
        if AutoFarm then
            local npc = getNPC()
            if npc then
                hrp.CFrame = npc.HumanoidRootPart.CFrame * TeleOffset
                kill(npc)
            end
        end
    end
end)

-- ===== BUTTON =====
btn.MouseButton1Click:Connect(function()
    AutoFarm = not AutoFarm
    btn.Text = AutoFarm and "AUTO FARM : ON" or "AUTO FARM : OFF"
end)            local distance = (humanoidRootPart.Position - npc.HumanoidRootPart.Position).Magnitude
            if distance < shortestDistance then
                shortestDistance = distance
                nearestNPC = npc
            end
        end
    end

    return nearestNPC
end

-- AUTO FARM LOOP
task.spawn(function()
    while task.wait(0.1) do
        if AUTO_FARM then
            local npc = getNearestNPC()
            if npc then
                humanoidRootPart.CFrame =
                    npc.HumanoidRootPart.CFrame * TELE_OFFSET

                task.wait(0.2)
                attackNPC(npc)
            end
        end
    end
end)

-- BUTTON TOGGLE
button.MouseButton1Click:Connect(function()
    AUTO_FARM = not AUTO_FARM
    button.Text = AUTO_FARM and "AUTO FARM : ON" or "AUTO FARM : OFF"
end)		Button.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
	else
		Button.Text = "Auto Lụm: OFF"
		Button.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
	end
end)

-- Auto kích hoạt ProximityPrompt
ProximityPromptService.PromptShown:Connect(function(prompt)
	if AutoPick and prompt.ActionText == "Lụm" then
		task.wait(0.1)
		fireproximityprompt(prompt)
	end
end)
