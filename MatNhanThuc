-- üì¶ Bi·∫øn ch√≠nh
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local mouse = player:GetMouse()

-- ‚öôÔ∏è C√†i ƒë·∫∑t
local autoAttack = false
local autoHeal = true
local healThreshold = 0.5
local healCooldown = 3
local distance = 22
local rotateSpeed = 2
local targetBoss = nil

-- üìä GUI
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "BossControl"

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 220)
frame.Position = UDim2.new(0, 100, 0.5, -100)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

-- Ti√™u ƒë·ªÅ
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Text = "B·∫¨T: ƒê√°nh Boss"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1
title.Font = Enum.Font.SourceSansBold
title.TextScaled = true

-- √î nh·∫≠p kho·∫£ng c√°ch
local distanceBox = Instance.new("TextBox", frame)
distanceBox.PlaceholderText = "Kho·∫£ng c√°ch"
distanceBox.Text = tostring(distance)
distanceBox.Position = UDim2.new(0, 20, 0, 40)
distanceBox.Size = UDim2.new(0, 100, 0, 30)

-- √î nh·∫≠p t·ªëc ƒë·ªô quay
local rotateBox = Instance.new("TextBox", frame)
rotateBox.PlaceholderText = "T·ªëc ƒë·ªô quay"
rotateBox.Text = tostring(rotateSpeed)
rotateBox.Position = UDim2.new(0, 140, 0, 40)
rotateBox.Size = UDim2.new(0, 100, 0, 30)

-- Label hi·ªÉn th·ªã m√°u m·ª•c ti√™u
local hpLabel = Instance.new("TextLabel", frame)
hpLabel.Position = UDim2.new(0, 0, 0, 80)
hpLabel.Size = UDim2.new(1, 0, 0, 30)
hpLabel.Text = "M√°u m·ª•c ti√™u: ???"
hpLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
hpLabel.BackgroundTransparency = 1
hpLabel.Font = Enum.Font.SourceSansBold
hpLabel.TextScaled = true

-- N√∫t auto ƒë√°nh
local autoBtn = Instance.new("TextButton", frame)
autoBtn.Text = "T·∫ÆT: Auto ƒê√°nh"
autoBtn.Position = UDim2.new(0.5, -100, 0, 120)
autoBtn.Size = UDim2.new(0, 200, 0, 30)
autoBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
autoBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
autoBtn.Font = Enum.Font.SourceSansBold
autoBtn.TextScaled = true

-- N√∫t auto h·ªìi m√°u
local healBtn = Instance.new("TextButton", frame)
healBtn.Text = "T·∫ÆT: Auto H·ªìi M√°u"
healBtn.Position = UDim2.new(0.5, -100, 0, 160)
healBtn.Size = UDim2.new(0, 200, 0, 30)
healBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
healBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
healBtn.Font = Enum.Font.SourceSansBold
healBtn.TextScaled = true

-- üëä Auto Attack Loop
spawn(function()
	while true do
		wait(0.1)
		if autoAttack and targetBoss and targetBoss:FindFirstChild("Humanoid") then
			local bossHumanoid = targetBoss.Humanoid
			hpLabel.Text = "M√°u m·ª•c ti√™u: " .. math.floor(bossHumanoid.Health)
			if bossHumanoid.Health <= 0 then
				hpLabel.Text = "M√°u m·ª•c ti√™u: ƒê√£ ch·∫øt"
				targetBoss = nil
			else
				-- Teleport & t·∫•n c√¥ng
				character:MoveTo(targetBoss.HumanoidRootPart.Position + Vector3.new(0, 0, -distance))
				character:SetPrimaryPartCFrame(CFrame.new(character.PrimaryPart.Position, targetBoss.HumanoidRootPart.Position))
				local attackRemote = ReplicatedStorage:FindFirstChild("AttackRemote")
				if attackRemote then
					attackRemote:FireServer()
				end
			end
		end
	end
end)

-- ‚ù§Ô∏è Auto Heal Loop
spawn(function()
	while wait(healCooldown) do
		if autoHeal and humanoid.Health / humanoid.MaxHealth < healThreshold then
			local bandageRemote = ReplicatedStorage:FindFirstChild("UseBandage")
			if bandageRemote then
				bandageRemote:FireServer()
			end
		end
	end
end)

-- üìå K√≠ch ho·∫°t c√°c n√∫t
autoBtn.MouseButton1Click:Connect(function()
	autoAttack = not autoAttack
	autoBtn.Text = (autoAttack and "T·∫ÆT: Auto ƒê√°nh" or "B·∫¨T: Auto ƒê√°nh")
end)

healBtn.MouseButton1Click:Connect(function()
	autoHeal = not autoHeal
	healBtn.Text = (autoHeal and "T·∫ÆT: Auto H·ªìi M√°u" or "B·∫¨T: Auto H·ªìi M√°u")
end)

-- üß† C·∫≠p nh·∫≠t gi√° tr·ªã kho·∫£ng c√°ch/t·ªëc ƒë·ªô
distanceBox.FocusLost:Connect(function()
	local val = tonumber(distanceBox.Text)
	if val then distance = val end
end)

rotateBox.FocusLost:Connect(function()
	local val = tonumber(rotateBox.Text)
	if val then rotateSpeed = val end
end)

-- üéØ X√°c ƒë·ªãnh boss khi nh·∫•n chu·ªôt
mouse.Button1Down:Connect(function()
	local target = mouse.Target
	if target and target:FindFirstAncestorWhichIsA("Model") then
		local model = target:FindFirstAncestorWhichIsA("Model")
		if model:FindFirstChild("Humanoid") then
			targetBoss = model
			hpLabel.Text = "ƒê√£ ch·ªçn Boss!"
		end
	end
end)
