-- Auto Collect Money (ProximityPrompt) - Smooth Version
-- LocalScript

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- GUI Toggle
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui
ScreenGui.ResetOnSpawn = false

local Toggle = Instance.new("TextButton")
Toggle.Size = UDim2.new(0, 180, 0, 50)
Toggle.Position = UDim2.new(0.05, 0, 0.3, 0)
Toggle.Text = "⚡ Auto Nhặt Tiền: Tắt ⚡"
Toggle.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
Toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
Toggle.TextScaled = true
Toggle.Parent = ScreenGui

local autoCollect = false
Toggle.MouseButton1Click:Connect(function()
    autoCollect = not autoCollect
    if autoCollect then
        Toggle.Text = "⚡ Auto Nhặt Tiền: Bật ⚡"
        Toggle.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    else
        Toggle.Text = "⚡ Auto Nhặt Tiền: Tắt ⚡"
        Toggle.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    end
end)

-- Function: Tìm ProximityPrompt gần nhất
local function getNearestPrompt()
    local nearest, dist = nil, math.huge
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("ProximityPrompt") and obj.Parent:IsA("Part") then
            local distance = (humanoidRootPart.Position - obj.Parent.Position).Magnitude
            if distance < dist and distance <= obj.MaxActivationDistance then
                nearest, dist = obj, distance
            end
        end
    end
    return nearest
end

-- Auto Collect Loop (mượt hơn, ít lag)
task.spawn(function()
    while task.wait(0.2) do -- check mỗi 0.2s thay vì 60 lần/giây
        if autoCollect and humanoidRootPart then
            local prompt = getNearestPrompt()
            if prompt then
                pcall(function()
                    fireproximityprompt(prompt)
                end)
            end
        end
    end
end)
