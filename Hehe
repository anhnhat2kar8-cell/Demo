local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer
local guiParent = lp:WaitForChild("PlayerGui")

-- Ä‘áº£m báº£o character luÃ´n há»£p lá»‡
local function getCharacter()
    return lp.Character or lp.CharacterAdded:Wait()
end

local chr = getCharacter()
local hum = chr:WaitForChild("Humanoid")
local hrp = chr:WaitForChild("HumanoidRootPart")

-- Biáº¿n
local farming = false
local radius = 22
local speed = 2
local autoAttack = true
local autoLoot = true
local autoHeal = true
local lastWeapon = nil

local bossMaxHealth = 15000
local bossHealth = bossMaxHealth

-- GUI chÃ­nh
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "RENX_GUI"
ScreenGui.Parent = guiParent

-- Main blurred-like frame (má» báº±ng transparency Ä‘á»ƒ giá»‘ng áº£nh)
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 250, 0, 150)
MainFrame.Position = UDim2.new(0.05, 0, 0.3, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MainFrame.BackgroundTransparency = 0.3
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui
MainFrame.Active = true
MainFrame.Draggable = true

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "ðŸ’€ ZENX ðŸ’€"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Parent = MainFrame

-- Farm Button
local FarmButton = Instance.new("TextButton")
FarmButton.Size = UDim2.new(1, -20, 0, 30)
FarmButton.Position = UDim2.new(0, 10, 0, 35)
FarmButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
FarmButton.BackgroundTransparency = 0.2
FarmButton.Text = "Báº­t Farm Boss"
FarmButton.Font = Enum.Font.GothamBold
FarmButton.TextSize = 18
FarmButton.TextColor3 = Color3.fromRGB(255, 255, 255)
FarmButton.Parent = MainFrame

-- Distance TextBox
local DistanceBox = Instance.new("TextBox")
DistanceBox.Size = UDim2.new(1, -20, 0, 30)
DistanceBox.Position = UDim2.new(0, 10, 0, 70)
DistanceBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
DistanceBox.BackgroundTransparency = 0.2
DistanceBox.PlaceholderText = "Khoáº£ng cÃ¡ch (VD: 22)"
DistanceBox.Text = tostring(radius)
DistanceBox.Font = Enum.Font.Gotham
DistanceBox.TextSize = 16
DistanceBox.TextColor3 = Color3.fromRGB(255, 255, 255)
DistanceBox.ClearTextOnFocus = false
DistanceBox.Parent = MainFrame

-- Speed TextBox
local SpeedBox = Instance.new("TextBox")
SpeedBox.Size = UDim2.new(1, -20, 0, 30)
SpeedBox.Position = UDim2.new(0, 10, 0, 105)
SpeedBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
SpeedBox.BackgroundTransparency = 0.2
SpeedBox.PlaceholderText = "Tá»‘c Ä‘á»™ vÃ²ng (VD: 2)"
SpeedBox.Text = tostring(speed)
SpeedBox.Font = Enum.Font.Gotham
SpeedBox.TextSize = 16
SpeedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedBox.ClearTextOnFocus = false
SpeedBox.Parent = MainFrame

-- Boss HP bar (gÃ³c trÃªn pháº£i)
local BossFrame = Instance.new("Frame")
BossFrame.Size = UDim2.new(0, 300, 0, 28)
BossFrame.Position = UDim2.new(1, -320, 0, 20) -- top-right area
BossFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
BossFrame.BackgroundTransparency = 0.2
BossFrame.BorderSizePixel = 0
BossFrame.Parent = ScreenGui

local BossBar = Instance.new("Frame")
BossBar.Size = UDim2.new(1, 0, 1, 0)
BossBar.Position = UDim2.new(0,0,0,0)
BossBar.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
BossBar.BorderSizePixel = 0
BossBar.Parent = BossFrame

local BossText = Instance.new("TextLabel")
BossText.Size = UDim2.new(1, 0, 1, 0)
BossText.Position = UDim2.new(0,0,0,0)
BossText.BackgroundTransparency = 1
BossText.Text = "MÃ¡u Boss: " .. bossHealth .. " / " .. bossMaxHealth
BossText.Font = Enum.Font.GothamBold
BossText.TextSize = 16
BossText.TextColor3 = Color3.fromRGB(255,255,255)
BossText.Parent = BossFrame

-- Helper: cáº­p nháº­t boss health bar
local function updateBossHealth(current, maximum)
    bossHealth = math.clamp(current or 0, 0, maximum or bossMaxHealth)
    bossMaxHealth = maximum or bossMaxHealth
    if bossMaxHealth > 0 then
        BossBar.Size = UDim2.new(bossHealth / bossMaxHealth, 0, 1, 0)
    else
        BossBar.Size = UDim2.new(0, 0, 1, 0)
    end
    BossText.Text = "MÃ¡u Boss: " .. math.floor(bossHealth) .. " / " .. math.floor(bossMaxHealth)
end

-- HÃ m tÃ¬m target (boss) trong workspace (giá»¯ logic cÅ©)
local function getTarget()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("Model") and v:FindFirstChild("Humanoid") and v ~= chr and v:FindFirstChild("HumanoidRootPart") and v.Humanoid.Health > 0 then
            return v
        end
    end
    return nil
end

-- Auto-heal: chuyá»ƒn sang bÄƒng gáº¡c khi cáº§n vÃ  sá»­ dá»¥ng
task.spawn(function()
    while true do
        task.wait(0.5)
        if autoHeal then
            -- refresh character in case of respawn
            chr = getCharacter()
            hum = chr:FindFirstChild("Humanoid") or hum
            hrp = chr:FindFirstChild("HumanoidRootPart") or hrp

            if hum and hum.Health and hum.Health < 80 then
                -- lÆ°u weapon hiá»‡n táº¡i náº¿u khÃ´ng pháº£i bÄƒng
                local tool = lp.Character and lp.Character:FindFirstChildOfClass("Tool")
                if tool and not tool.Name:lower():find("bÄƒng") then
                    lastWeapon = tool
                end

                -- tÃ¬m bÄƒng trong backpack
                local found = nil
                for _, t in ipairs(lp.Backpack:GetChildren()) do
                    if t:IsA("Tool") and t.Name:lower():find("bÄƒng") then
                        found = t
                        break
                    end
                end

                if found then
                    found.Parent = lp.Character
                    wait(0.15)
                    local healTool = lp.Character:FindFirstChildWhichIsA("Tool")
                    if healTool and healTool.Name:lower():find("bÄƒng") then
                        pcall(function() healTool:Activate() end)
                        wait(1)
                        -- tráº£ vÅ© khÃ­ cÅ© náº¿u cÃ³
                        if lastWeapon and lastWeapon.Parent == lp.Backpack then
                            lastWeapon.Parent = lp.Character
                        end
                    end
                end
            end
        end
    end
end)

-- Auto-loot: tá»± tÆ°Æ¡ng tÃ¡c ProximityPrompt trong pháº¡m vi
task.spawn(function()
    while true do
        task.wait(0.5)
        if autoLoot then
            chr = getCharacter()
            hrp = chr:FindFirstChild("HumanoidRootPart") or hrp
            if hrp then
                for _, prompt in pairs(workspace:GetDescendants()) do
                    if prompt and prompt:IsA("ProximityPrompt") and (prompt.Parent:IsA("BasePart") or prompt.Parent:IsA("MeshPart")) then
                        local ok, pos = pcall(function() return prompt.Parent.Position end)
                        if ok and pos then
                            local dist = (hrp.Position - pos).Magnitude
                            if dist <= 15 then
                                pcall(function() fireproximityprompt(prompt) end)
                                wait(0.15)
                            end
                        end
                    end
                end
            end
        end
    end
end)

-- Auto-attack function: activate tool
local function attack()
    local tool = lp.Character and lp.Character:FindFirstChildOfClass("Tool")
    if tool then
        pcall(function() tool:Activate() end)
    end
end

-- Cáº­p nháº­t boss HP theo target náº¿u tÃ¬m Ä‘Æ°á»£c humanoid boss
task.spawn(function()
    while true do
        task.wait(0.1)
        local target = getTarget()
        if target and target:FindFirstChild("Humanoid") then
            local h = target.Humanoid.Health or 0
            local m = target.Humanoid.MaxHealth or bossMaxHealth
            updateBossHealth(h, m)
        else
            -- khi khÃ´ng cÃ³ target, giá»¯ hiá»ƒn thá»‹ hiá»‡n táº¡i hoáº·c vá» 0
            -- updateBossHealth(0, bossMaxHealth)
        end
    end
end)

-- Di chuyá»ƒn quanh boss vÃ  auto attack
RunService.Heartbeat:Connect(function()
    if farming then
        local target = getTarget()
        if target and target:FindFirstChild("HumanoidRootPart") then
            local thrp = target:FindFirstChild("HumanoidRootPart")
            -- tÃ­nh gÃ³c + offset
            local angle = tick() * speed
            local offset = Vector3.new(math.cos(angle) * radius, 0, math.sin(angle) * radius)
            local goalPos = thrp.Position + offset
            -- dÃ¹ng tween Ä‘á»ƒ di chuyá»ƒn mÆ°á»£t
            local ok, tween = pcall(function()
                return TweenService:Create(hrp, TweenInfo.new(0.12, Enum.EasingStyle.Linear), {CFrame = CFrame.new(goalPos, thrp.Position)})
            end)
            if ok and tween then
                pcall(function() tween:Play() end)
            else
                -- fallback: trá»±c tiáº¿p set CFrame (thÆ°á»ng Ã­t mÆ°á»£t hÆ¡n)
                pcall(function() hrp.CFrame = CFrame.new(goalPos, thrp.Position) end)
            end

            -- disable AutoRotate Ä‘á»ƒ nhÃ¬n Ä‘Ãºng hÆ°á»›ng
            if hum then
                pcall(function() hum.AutoRotate = false end)
            end

            -- attack náº¿u báº­t
            if autoAttack then
                attack()
            end
        end
    end
end)

-- NÃºt báº¥m farm
FarmButton.MouseButton1Click:Connect(function()
    farming = not farming
    FarmButton.Text = farming and "Táº¯t Farm Boss" or "Báº­t Farm Boss"
end)

-- TextBox xá»­ lÃ½
DistanceBox.FocusLost:Connect(function(enterPressed)
    local num = tonumber(DistanceBox.Text)
    if num and num > 0 then
        radius = num
        DistanceBox.Text = tostring(radius)
    else
        DistanceBox.Text = tostring(radius)
    end
end)

SpeedBox.FocusLost:Connect(function(enterPressed)
    local num = tonumber(SpeedBox.Text)
    if num and num > 0 then
        speed = num
        SpeedBox.Text = tostring(speed)
    else
        SpeedBox.Text = tostring(speed)
    end
end)

-- Náº¿u ngÆ°á»i chÆ¡i respawn thÃ¬ cáº­p nháº­t láº¡i cÃ¡c tham chiáº¿u
lp.CharacterAdded:Connect(function(char)
    chr = char
    hum = chr:WaitForChild("Humanoid")
    hrp = chr:WaitForChild("HumanoidRootPart")
end)

-- (Optional) Demo giáº£m mÃ¡u boss khi farming Ä‘á»ƒ tháº¥y thanh hoáº¡t Ä‘á»™ng
-- Náº¿u game thá»±c táº¿ cÃ³ boss, Ä‘oáº¡n nÃ y khÃ´ng cáº§n vÃ  cÃ³ thá»ƒ xÃ³a.
task.spawn(function()
    while true do
        task.wait(2)
        -- náº¿u Ä‘ang farming, giáº£ láº­p giáº£m hp Ä‘á»ƒ tháº¥y thanh thay Ä‘á»•i (bá» hoáº·c chá»‰nh náº¿u game tháº­t Ä‘Ã£ cÃ³ boss)
        if farming and bossHealth > 0 then
            updateBossHealth(bossHealth - math.random(80, 250), bossMaxHealth)
        end
    end
end)

-- END
