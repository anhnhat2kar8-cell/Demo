local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local lp = Players.LocalPlayer
local guiParent = lp:WaitForChild("PlayerGui")

-- === Character refs ===
local function getCharacter()
    return lp.Character or lp.CharacterAdded:Wait()
end
local chr = getCharacter()
local hum = chr:WaitForChild("Humanoid")
local hrp = chr:WaitForChild("HumanoidRootPart")

-- === Config ===
local farming = false
local radius = 25   -- bÃ¡n kÃ­nh bay quanh boss
local height = 10   -- Ä‘á»™ cao so vá»›i boss
local autoAttack = true

-- === GUI ===
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ZENX_GUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = guiParent

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 280, 0, 160)
MainFrame.Position = UDim2.new(0.05, 0, 0.25, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
MainFrame.BackgroundTransparency = 0.28
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 10)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 36)
Title.Position = UDim2.new(0, 0, 0, 6)
Title.BackgroundTransparency = 1
Title.Text = "ðŸ’€ ZENX FARM ðŸ’€"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Parent = MainFrame

local FarmButton = Instance.new("TextButton")
FarmButton.Size = UDim2.new(1, -24, 0, 40)
FarmButton.Position = UDim2.new(0, 12, 0, 50)
FarmButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
FarmButton.BackgroundTransparency = 0.38
FarmButton.Text = "Báº­t Farm Boss"
FarmButton.Font = Enum.Font.GothamBold
FarmButton.TextSize = 18
FarmButton.TextColor3 = Color3.fromRGB(255,255,255)
FarmButton.Parent = MainFrame
Instance.new("UICorner", FarmButton).CornerRadius = UDim.new(0, 8)

FarmButton.MouseButton1Click:Connect(function()
    farming = not farming
    FarmButton.Text = farming and "Táº¯t Farm Boss" or "Báº­t Farm Boss"
end)

-- === TÃ¬m boss gáº§n nháº¥t ===
local function findBoss()
    local chosen, shortest = nil, math.huge
    local myPos = hrp.Position
    for _, v in pairs(Workspace:GetDescendants()) do
        if v:IsA("Model") and v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") then
            local humv = v:FindFirstChild("Humanoid")
            if humv and humv.Health > 0 then
                local owner = Players:GetPlayerFromCharacter(v)
                if not owner then
                    local d = (v.HumanoidRootPart.Position - myPos).Magnitude
                    if d < shortest then
                        chosen = v
                        shortest = d
                    end
                end
            end
        end
    end
    return chosen
end

-- === Auto Attack ===
local function attack()
    local tool = lp.Character and lp.Character:FindFirstChildOfClass("Tool")
    if tool then
        pcall(function() tool:Activate() end)
    end
end

-- === Bay theo waypoint quanh boss ===
RunService.Heartbeat:Connect(function()
    if farming and hum and hum.Health > 0 then
        local target = findBoss()
        if target and target:FindFirstChild("HumanoidRootPart") and target.Humanoid.Health > 0 then
            local thrp = target.HumanoidRootPart
            local t = tick() * 1.5 -- tá»‘c Ä‘á»™ quay
            local offset = Vector3.new(
                math.cos(t) * radius,
                height,
                math.sin(t) * radius
            )
            local goalPos = thrp.Position + offset

            -- di chuyá»ƒn mÆ°á»£t theo waypoint
            hrp.CFrame = hrp.CFrame:Lerp(CFrame.new(goalPos, thrp.Position), 0.2)

            -- tá»± Ä‘á»™ng Ä‘Ã¡nh boss
            if autoAttack then
                attack()
            end
        end
    end
end)

-- === Respawn Handler ===
lp.CharacterAdded:Connect(function(char)
    chr = char
    hum = chr:WaitForChild("Humanoid")
    hrp = chr:WaitForChild("HumanoidRootPart")
end)
