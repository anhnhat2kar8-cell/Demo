local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local VirtualUser = game:GetService("VirtualUser")

local lp = Players.LocalPlayer
local char = lp.Character or lp.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local hum = char:WaitForChild("Humanoid")

-- cập nhật khi respawn
lp.CharacterAdded:Connect(function(c)
	char = c
	hrp = c:WaitForChild("HumanoidRootPart")
	hum = c:WaitForChild("Humanoid")
end)

-- trạng thái
local autoClick = false
local autoRotate = false
local speedHack = false
local speedValue = 16 -- mặc định

-- GUI
local ScreenGui = Instance.new("ScreenGui", lp.PlayerGui)
local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 250, 0, 200)
Frame.Position = UDim2.new(0, 50, 0, 200)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.Active = true
Frame.Draggable = true

local UIListLayout = Instance.new("UIListLayout", Frame)
UIListLayout.Padding = UDim.new(0, 5)

-- helper tạo nút toggle
local function createButton(txt, callback)
	local btn = Instance.new("TextButton", Frame)
	btn.Size = UDim2.new(1, -10, 0, 30)
	btn.Position = UDim2.new(0, 5, 0, 0)
	btn.Text = txt
	btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	btn.TextColor3 = Color3.new(1,1,1)
	btn.MouseButton1Click:Connect(function()
		callback(btn)
	end)
	return btn
end

-- Auto Click
createButton("Auto Click: OFF", function(btn)
	autoClick = not autoClick
	btn.Text = "Auto Click: " .. (autoClick and "ON" or "OFF")
end)

-- Auto Rotate quanh boss
createButton("Auto Rotate: OFF", function(btn)
	autoRotate = not autoRotate
	btn.Text = "Auto Rotate: " .. (autoRotate and "ON" or "OFF")
end)

-- Speed Hack toggle
createButton("Speed Hack: OFF", function(btn)
	speedHack = not speedHack
	btn.Text = "Speed Hack: " .. (speedHack and "ON" or "OFF")
	if speedHack then
		hum.WalkSpeed = speedValue
	else
		hum.WalkSpeed = 16
	end
end)

-- Ô nhập tốc độ
local speedBox = Instance.new("TextBox", Frame)
speedBox.Size = UDim2.new(1, -10, 0, 30)
speedBox.Position = UDim2.new(0, 5, 0, 0)
speedBox.PlaceholderText = "Nhập tốc độ chạy"
speedBox.Text = ""
speedBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
speedBox.TextColor3 = Color3.new(1,1,1)
speedBox.FocusLost:Connect(function()
	local val = tonumber(speedBox.Text)
	if val and val > 0 then
		speedValue = val
		if speedHack then
			hum.WalkSpeed = speedValue
		end
	end
end)

-- Auto Click mượt (RenderStepped)
RunService.RenderStepped:Connect(function()
	if autoClick then
		VirtualUser:Button1Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
		VirtualUser:Button1Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
	end
end)

-- Auto Rotate quanh boss (ví dụ tìm NPC gần nhất)
local radius = 10
RunService.Heartbeat:Connect(function()
	if autoRotate and hrp then
		local nearestBoss, dist = nil, math.huge
		for _, mob in ipairs(workspace:GetChildren()) do
			if mob:FindFirstChild("Humanoid") and mob:FindFirstChild("HumanoidRootPart") and mob.Humanoid.Health > 0 then
				local d = (mob.HumanoidRootPart.Position - hrp.Position).Magnitude
				if d < dist then
					dist = d
					nearestBoss = mob
				end
			end
		end
		if nearestBoss then
			local angle = tick() * 2 -- tốc độ xoay
			local offset = Vector3.new(math.cos(angle), 0, math.sin(angle)) * radius
			local targetPos = nearestBoss.HumanoidRootPart.Position + offset
			hrp.CFrame = CFrame.new(targetPos, nearestBoss.HumanoidRootPart.Position)
		end
	end
end)
