local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local lp = Players.LocalPlayer
local guiParent = lp:WaitForChild("PlayerGui")

-- Láº¥y character an toÃ n
local function getCharacter()
    return lp.Character or lp.CharacterAdded:Wait()
end

local chr = getCharacter()
local hum = chr:FindFirstChild("Humanoid") or chr:WaitForChild("Humanoid")
local hrp = chr:FindFirstChild("HumanoidRootPart") or chr:WaitForChild("HumanoidRootPart")

-- Biáº¿n chÃ­nh
local farming = false
local radius = 22
local speed = 2
local autoAttack = true
local autoLoot = true
local autoHeal = true

local bossMaxHealth = 15000
local bossHealth = bossMaxHealth

-- ====== GUI ======
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ZENX_GUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = guiParent

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 260, 0, 180)
MainFrame.Position = UDim2.new(0.04, 0, 0.25, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
MainFrame.BackgroundTransparency = 0.32
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 10)
mainCorner.Parent = MainFrame

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 36)
Title.Position = UDim2.new(0, 0, 0, 6)
Title.BackgroundTransparency = 1
Title.Text = "ðŸ’€ ZENX ðŸ’€"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextXAlignment = Enum.TextXAlignment.Center
Title.Parent = MainFrame

-- Farm Button
local FarmButton = Instance.new("TextButton")
FarmButton.Size = UDim2.new(1, -24, 0, 38)
FarmButton.Position = UDim2.new(0, 12, 0, 48)
FarmButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
FarmButton.BackgroundTransparency = 0.38
FarmButton.Text = "Báº­t Farm Boss"
FarmButton.Font = Enum.Font.GothamBold
FarmButton.TextSize = 20
FarmButton.TextColor3 = Color3.fromRGB(255,255,255)
FarmButton.Parent = MainFrame

local farmCorner = Instance.new("UICorner")
farmCorner.CornerRadius = UDim.new(0, 8)
farmCorner.Parent = FarmButton

-- HÃ m táº¡o Ã´ nháº­p giáº£ (cÃ¢n giá»¯a + má» + bo gÃ³c)
local function createEditableLabel(yPos, labelText, getValue, setValue)
    local LabelButton = Instance.new("TextButton")
    LabelButton.Size = UDim2.new(1, -24, 0, 34)
    LabelButton.Position = UDim2.new(0, 12, 0, yPos)
    LabelButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    LabelButton.BackgroundTransparency = 0.38
    LabelButton.Font = Enum.Font.Gotham
    LabelButton.TextSize = 18
    LabelButton.TextColor3 = Color3.fromRGB(245, 245, 245)
    LabelButton.TextXAlignment = Enum.TextXAlignment.Center
    LabelButton.Text = labelText .. " (VD: " .. tostring(getValue()) .. ")"
    LabelButton.Parent = MainFrame

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = LabelButton

    LabelButton.MouseButton1Click:Connect(function()
        -- Táº¡o TextBox táº¡m thay tháº¿ nÃºt
        local TempBox = Instance.new("TextBox")
        TempBox.Size = LabelButton.Size
        TempBox.Position = LabelButton.Position
        TempBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
        TempBox.BackgroundTransparency = 0.38
        TempBox.Font = Enum.Font.Gotham
        TempBox.TextSize = 18
        TempBox.TextColor3 = Color3.fromRGB(245,245,245)
        TempBox.ClearTextOnFocus = false
        TempBox.TextXAlignment = Enum.TextXAlignment.Center
        TempBox.Text = tostring(getValue())
        TempBox.Parent = MainFrame

        local corner2 = Instance.new("UICorner")
        corner2.CornerRadius = UDim.new(0, 8)
        corner2.Parent = TempBox

        -- Báº¯t focus Ä‘á»ƒ hiá»‡n bÃ n phÃ­m trÃªn mobile
        TempBox:CaptureFocus()

        TempBox.FocusLost:Connect(function(enterPressed)
            local num = tonumber(TempBox.Text)
            if num then
                setValue(num)
            end
            LabelButton.Text = labelText .. " (VD: " .. tostring(getValue()) .. ")"
            TempBox:Destroy()
        end)
    end)

    return LabelButton
end

-- Khoáº£ng cÃ¡ch & Tá»‘c Ä‘á»™ vÃ²ng
local distLabel = createEditableLabel(96, "Khoáº£ng cÃ¡ch", function() return radius end, function(v) radius = v end)
local speedLabel = createEditableLabel(136, "Tá»‘c Ä‘á»™ vÃ²ng", function() return speed end, function(v) speed = v end)

-- Boss HP bar (gÃ³c pháº£i)
local BossFrame = Instance.new("Frame")
BossFrame.Size = UDim2.new(0, 320, 0, 30)
BossFrame.Position = UDim2.new(1, -340, 0, 18) -- gÃ³c pháº£i
BossFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
BossFrame.BackgroundTransparency = 0.28
BossFrame.BorderSizePixel = 0
BossFrame.Parent = ScreenGui

local bossCorner = Instance.new("UICorner")
bossCorner.CornerRadius = UDim.new(0, 8)
bossCorner.Parent = BossFrame

local BossBarBG = Instance.new("Frame")
BossBarBG.Size = UDim2.new(1, -8, 1, -8)
BossBarBG.Position = UDim2.new(0, 4, 0, 4)
BossBarBG.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
BossBarBG.BackgroundTransparency = 0.24
BossBarBG.BorderSizePixel = 0
BossBarBG.Parent = BossFrame

local bossBGCorner = Instance.new("UICorner")
bossBGCorner.CornerRadius = UDim.new(0, 6)
bossBGCorner.Parent = BossBarBG

local BossBar = Instance.new("Frame")
BossBar.Size = UDim2.new(1, 0, 1, 0)
BossBar.BackgroundColor3 = Color3.fromRGB(200, 30, 30)
BossBar.BorderSizePixel = 0
BossBar.Parent = BossBarBG

local BossText = Instance.new("TextLabel")
BossText.Size = UDim2.new(1, 0, 1, 0)
BossText.BackgroundTransparency = 1
BossText.Text = "MÃ¡u Boss: " .. tostring(bossHealth) .. " / " .. tostring(bossMaxHealth)
BossText.Font = Enum.Font.GothamBold
BossText.TextSize = 16
BossText.TextColor3 = Color3.fromRGB(255,255,255)
BossText.TextXAlignment = Enum.TextXAlignment.Center
BossText.Parent = BossFrame

local function updateBossHealth(current, maximum)
    bossHealth = math.clamp(current or 0, 0, maximum or bossMaxHealth)
    bossMaxHealth = maximum or bossMaxHealth
    local pct = 0
    if bossMaxHealth > 0 then pct = bossHealth / bossMaxHealth end
    BossBar:TweenSize(UDim2.new(pct, 0, 1, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.12, true)
    BossText.Text = "MÃ¡u Boss: " .. math.floor(bossHealth) .. " / " .. math.floor(bossMaxHealth)
end

-- ====== Logic Auto / Attack / Loot / Heal (tá»‘i Æ°u: cháº¡y Ã­t vÃ²ng khi khÃ´ng farming) ======

-- TÃ¬m target boss (Ä‘Æ¡n giáº£n: model cÃ³ Humanoid vÃ  HumanoidRootPart, != player)
local function getTarget()
    for _, v in pairs(Workspace:GetDescendants()) do
        if v:IsA("Model") and v ~= chr and v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") then
            if v.Humanoid.Health > 0 then
                return v
            end
        end
    end
    return nil
end

-- Auto heal (cháº¡y má»—i 0.6s, chá»‰ kiá»ƒm tra náº¿u autoHeal = true)
task.spawn(function()
    while true do
        task.wait(0.6)
        if not autoHeal then continue end
        chr = getCharacter()
        hum = chr:FindFirstChild("Humanoid") or hum
        hrp = chr:FindFirstChild("HumanoidRootPart") or hrp
        if hum and hum.Health and hum.Health < 80 then
            local lastWeapon = nil
            local tool = lp.Character and lp.Character:FindFirstChildOfClass("Tool")
            if tool and not tool.Name:lower():find("bÄƒng") then
                lastWeapon = tool
            end
            for _, t in ipairs(lp.Backpack:GetChildren()) do
                if t:IsA("Tool") and t.Name:lower():find("bÄƒng") then
                    t.Parent = lp.Character
                    task.wait(0.15)
                    local healTool = lp.Character:FindFirstChildWhichIsA("Tool")
                    if healTool and healTool.Name:lower():find("bÄƒng") then
                        pcall(function() healTool:Activate() end)
                        task.wait(1)
                        if lastWeapon and lastWeapon.Parent == lp.Backpack then
                            lastWeapon.Parent = lp.Character
                        end
                    end
                    break
                end
            end
        end
    end
end)

-- Auto loot (chá»‰ khi farming vÃ  autoLoot báº­t)
task.spawn(function()
    while true do
        task.wait(0.5)
        if not farming or not autoLoot then continue end
        chr = getCharacter()
        hrp = chr:FindFirstChild("HumanoidRootPart") or hrp
        if hrp then
            for _, prompt in pairs(Workspace:GetDescendants()) do
                if prompt:IsA("ProximityPrompt") then
                    local ok, pos = pcall(function() return prompt.Parent.Position end)
                    if ok and pos and (hrp.Position - pos).Magnitude <= 16 then
                        pcall(function() fireproximityprompt(prompt) end)
                        task.wait(0.12)
                    end
                end
            end
        end
    end
end)

-- Auto attack (kÃ­ch hoáº¡t tool khi farming)
local function attack()
    if not farming or not autoAttack then return end
    local tool = lp.Character and lp.Character:FindFirstChildOfClass("Tool")
    if tool then
        pcall(function() tool:Activate() end)
    end
end

-- Cáº­p nháº­t boss health liÃªn tá»¥c (nhÆ°ng nháº¹, 0.12s)
task.spawn(function()
    while true do
        task.wait(0.12)
        local target = getTarget()
        if target and target:FindFirstChild("Humanoid") then
            updateBossHealth(target.Humanoid.Health, target.Humanoid.MaxHealth)
        else
            updateBossHealth(0, bossMaxHealth)
        end
    end
end)

-- Di chuyá»ƒn quanh boss khi farming (dÃ¹ng Heartbeat)
RunService.Heartbeat:Connect(function()
    if not farming then
        if hum then pcall(function() hum.AutoRotate = true end) end
        return
    end

    local target = getTarget()
    if target and target:FindFirstChild("HumanoidRootPart") then
        local thrp = target.HumanoidRootPart
        local ang = tick() * (tonumber(speed) or 2)
        local off = Vector3.new(math.cos(ang) * (tonumber(radius) or 22), 0, math.sin(ang) * (tonumber(radius) or 22))
        local goalPos = thrp.Position + off
        local ok, tween = pcall(function()
            return TweenService:Create(hrp, TweenInfo.new(0.12, Enum.EasingStyle.Linear), {CFrame = CFrame.new(goalPos, thrp.Position)})
        end)
        if ok and tween then
            tween:Play()
        else
            pcall(function() hrp.CFrame = CFrame.new(goalPos, thrp.Position) end)
        end
        if hum then pcall(function() hum.AutoRotate = false end) end
        attack()
    end
end)

-- Farm button toggle: Ä‘á»•i text thÃ nh "Äang Farm Boss..." khi báº­t
FarmButton.MouseButton1Click:Connect(function()
    farming = not farming
    if farming then
        FarmButton.Text = "Äang Farm Boss..."
    else
        FarmButton.Text = "Báº­t Farm Boss"
    end
end)

-- Khi respawn cáº­p nháº­t character refs
lp.CharacterAdded:Connect(function(char)
    chr = char
    hum = chr:WaitForChild("Humanoid")
    hrp = chr:WaitForChild("HumanoidRootPart")
end)

-- END - Script Ä‘Ã£ hoÃ n chá»‰nh
